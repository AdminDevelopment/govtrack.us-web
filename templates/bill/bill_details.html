{% extends "master_a.html" %}
{% load humanize %}
{% load govtrack_utils %}

{% block title %}{{bill.title_no_number}} ({% if not bill.is_current %}{{bill.current_status_date|date:"Y"}}; {{bill.congress|ordinal}} Congress {% endif %}{{bill.display_number_no_congress_number}}) - GovTrack.us{% endblock %}

{% block meta_description %}{% if not bill.is_current %}{{bill.current_status_date}}. {% endif %}{{bill.display_number}}. {% if subtitle %}{{subtitle}}{% endif %} In GovTrack.us, a database of bills in the U.S. Congress.{% endblock %}
{% block meta_keywords %}U.S. Congress,Congress,legislation,bill{% for term in bill.terms.all %}{% if 10 > forloop.counter %},{{term}}{% endif %}{% endfor %},law{% endblock %}

{% block og_image %}
	{% if bill.congress >= 112 %}
		{% with text as text_info %}
			{% if text_info.thumbnail_path %}
				<meta property="og:image" content="http://www.govtrack.us/{{text_info.thumbnail_path}}"/>
				<meta property="og:image:secure_url" content="https://www.govtrack.us/{{text_info.thumbnail_path}}"/>
				<meta property="twitter:image:src" content="https://www.govtrack.us/{{text_info.thumbnail_path}}"/>
			{% else %}
				<meta property="og:image" content="http://www.govtrack.us/static/images/media_icon.png?20130118"
				<meta property="og:image:secure_url" content="https://www.govtrack.us/static/images/media_icon.png?20130118"
				/>
				<meta property="twitter:image:src" content="https://www.govtrack.us/static/images/media_icon.png?20130118"
			{% endif %}
		{% endwith %}
	{% else %}
		<meta property="og:image" content="http://www.govtrack.us/static/images/media_icon.png?20130118" />
		<meta property="og:image:secure_url" content="https://www.govtrack.us/static/images/media_icon.png?20130118" />
		<meta property="twitter:image:src" content="https://www.govtrack.us/static/images/media_icon.png?20130118" />
	{% endif %}
	<meta name="twitter:card" content="summary">
	<meta name="twitter:title" content="{{bill.title}}">
	<meta name="twitter:description" content="{{subtitle}}">
{% endblock %}

{% block head %}
	<meta property="og:title" content="{{bill.title_no_number}} ({% if not bill.is_current %}{{bill.current_status_date|date:"Y"}}{% endif %}{{bill.display_number_no_congress_number}})" />
	<meta property="og:description" content="{% if subtitle %}{{subtitle}}{% else %}A {{bill.noun}} in the U.S. Congress.{% endif %}" />
	<meta property="og:url" content="https://www.govtrack.us{{bill.get_absolute_url}}" />
	<meta property="og:type" content="og_govtrack:bill">

	<script>
		// Handle click on a Facebook action link.
		var fb_action_target_url = "https://www.govtrack.us{{bill.get_absolute_url|escapejs}}";
		var fb_actions = null;
		
		var fb_is_logged_in = false;
		function fb_ensure_logged_in(callback) {
			if (fb_is_logged_in) {
				callback();
				return;
			}
			
			FB.login(function(response) {
				fb_is_logged_in = true;
				callback();
			 }, {scope: 'publish_actions'});			
		}
		
		function fb_set_initial_state(){
			var getLoginStatusCallback = function(response) {
				// firefox doesn't do anything unless we do something here??
				function blah() { }
				blah(response.status);
				
				if (response.status != "connected") {
					update_fb_action_status();
				} else {
					fb_get_current_actions(update_fb_action_status);
					
					// look ahead for the user's current permission so we
					// don't have to force a login later
					FB.api('/me/permissions', function (response) {
						fb_is_logged_in = "publish_actions" in response.data[0];
					} );					
				}
			}
			FB.getLoginStatus(getLoginStatusCallback, true);
		}
		
		function fb_get_current_actions(callback) {
			fb_actions = { };
			fb_get_current_actions_2("track", callback);
			fb_get_current_actions_2("support", callback);
			fb_get_current_actions_2("oppose", callback);
		}
		
		function fb_get_current_actions_2(action_name, callback){
			FB.api(
			  '/me/og_govtrack:' + action_name,
			  'get',
			  function(response) {
				fb_actions[action_name] = null;
				for (var i = 0; i < response.data.length; i++) {
					if (response.data[i].data.bill.url == fb_action_target_url)
						fb_actions[action_name] = response.data[i].id;
				}
				if ("track" in fb_actions && "support" in fb_actions && "oppose" in fb_actions) {
					// all three queries are completed
					callback();
				}
			  }
			);
		}
		
		function update_fb_action_status() {
			$('.share-on-fb-new').show();
			$('.share-on-fb-existing').hide();
			$('.share-on-fb .no_hover').text("Share");
			if (!fb_actions) return;
			for (var ax in fb_actions) {
				if (!fb_actions[ax]) continue;
				$('.share-on-fb-new').hide();
				$('.share-on-fb-existing').show();
				if (ax == "track") ax = "am tracking";
				$('.share-on-fb-existing span').text("I " + ax + " this bill.")
				$('.share-on-fb .no_hover').text("Shared!");
				return;
			}
		}
		
		function fb_unshare(dont_show_divs) {
			if (!fb_actions) return; // not initialized, so how are we unsharing?
			for (var ax in fb_actions) {
				if (fb_actions[ax]) {
					// log in and delete the action
					var og_url = '/' + fb_actions[ax]; // get it now before we modify global var
					fb_ensure_logged_in(function() {
						FB.api(
						  og_url,
						  'delete',
						  function(response) {
						  }
						);			
					 });
					 
					// clear now so it's not async with updating the display immediately
					fb_actions[ax] = null;
				}
			}
			if (!dont_show_divs) {
				update_fb_action_status();
			}
			return false;
		}
		
		function fb_share(action_name) {
			// already did this?
			if (fb_actions && fb_actions[action_name]) return false;
			
			// this takes some time, so show a 'working' div.
			$('.share-on-fb-working').show();
			$('.share-on-fb-new').hide();
			$('.share-on-fb-existing').hide();
			$('.share-on-fb .no_hover').text("Sharing...");
			
			// make sure we have permission (w/ correct scope) to post the action first...
			fb_ensure_logged_in(function() {
				// get current actions if we don't already have it
				if (!fb_actions)
					fb_get_current_actions(function() { fb_share_2(action_name); });
				else
					fb_share_2(action_name);
			 });
			 
			return false;
		}
			
		function fb_share_2(action_name) {
			if (fb_actions[action_name]) {
				// If, after logging in, it turns out we already did this,
				// then return.
				update_fb_action_status();
				$('.share-on-fb-working').hide();
				return;
			}
			
			// delete existing actions on this bill...
			// can be async with next because we know the desired action
			// doesn't exist, so we're free to create it at the same time
			// we delete anything else.
			fb_unshare(true);
			
			var action_obj = {
				bill: fb_action_target_url,
				"fb:explicitly_shared": true
			};
			if (window.location.hash == "#fb-staging") {
			}
			
			// post new action
			FB.api(
			  '/me/og_govtrack:' + action_name,
			  'post',
			  action_obj,
			  function(response) {
				fb_actions[action_name] = response.id;
				update_fb_action_status();
				$('.share-on-fb-working').hide();
			  }
			);			
		}
				
	window.fbAsyncInitFuncs.push(fb_set_initial_state); // must be before FB script is loaded
	</script>
{% endblock %}

{% block body_scripts %}
<script>
    $('#event_subscribe_inline_container').html(the_page.events_subscribe_button);
    
</script>
{% endblock %}

{% block extra_css %}
<!-- bid:{{bill.id}} -->
<style>
.panes {
	background-color: #fefaf6;
	border-left: 1px solid #ddc;
	border-right: 1px solid #ddc;
	border-bottom: 1px solid #ddc;
}

.minor_vote {
	display: none;
}

#action-panel h1 { font-size: 20px; }
#action-panel h2 { font-size: 16px; }

.progress-item {
	background-image: url(/static/images/bill_details_progress_bg_senate.png);
	background-repeat: no-repeat;
	min-height: 100px;
	margin: 0 -15px;
	padding: 0 15px;
}
	.progress-item .date {
		width: 255px;
		text-align: center;
		height: 20px;
	}

#prognosis_factors p span, #prognosis_factors .key { color: #777; font-family: Arial, Helvetica, sans-serif;}

#call_congress_positions button {
	display: inline-block;
	margin-top: .75em;
	margin-left: 2em;
	padding: 8px;
	font: 18px/24px Ubuntu, Verdana, Tahoma, Arial, sans-serif;
	text-align: center;
}
	#call_congress_positions button span {
		display: block;
		font-size: 42px;
		margin-top: 10px;
	}
		#call_congress_positions button.support span { color: green; }
		#call_congress_positions button.oppose span { color: red; }

#details dl, #details p {
	margin: 0;
}
#details dl dt {
	margin-top: 1em;
}

#details .sep {
	border-bottom: 1px solid #EDC;
	height: 0;
	margin: 2em 0 1em 0;
}

#details dt, #related dt {
	font-weight: normal;
	color: #000;
	margin-bottom: 6px;
}

#details table {
       width: 100%;
       margin: 0 0 14px;
       font-size: 13px;
       position: relative;
       }
       #details table td {
               padding: 0 2px 0 8px;
               vertical-align: middle;
               }
       #details table td.done {
               padding-left: 28px;
               background: url('/static/images/ico-checked.gif') 8px center no-repeat;
               }
       #details table td.pending {
               padding-left: 28px;
               background: url('/static/images/ico-unchecked.gif') 8px center no-repeat;
               }
       #details table .odd.done td { background: #e4e9e8 url('/static/images/ico-checked.gif') 8px center no-repeat; }
       #details table .odd.pending td { background: #e4e9e8 url('/static/images/ico-unchecked.gif') 8px center no-repeat; }
       #details tr.highlight td { font-weight: bold; }

</style>
{% endblock %}

{% block crumbs %}
<ul>
	<li><a href="{% url "congress_home" %}">Congress</a></li>
	<li><a href="/congress/bills">Bills</a></li>
	<li>{{bill.display_number}}</li>
</ul>
{% endblock %}

{% block body_class %}bill{% endblock %}

{% block summary %}

	<h1 style="max-height: 3.5em; overflow: hidden;">{{bill.display_number_no_congress_number}}{% if not bill.is_current%} ({{bill.congress|ordinalhtml}}){% endif %}: {{bill.title_no_number}}</h1>
	<div class="row">
	<div id="track_panel_base" class="{% if bill.is_alive %}col-sm-8{% else %}col-sm-12{% endif %}">
		<div class="info" {% if not bill.is_alive %}style="width: auto;"{% endif %}>
			<p id="h1_overflow" style="display: none;">...</p>
			<script>$('h1').truncate_text(function (remaining, chopped) {
			    if (chopped) $('#h1_overflow').text("..." + chopped).show();
			});</script>
		
			{% comment %}
			<p class="date"></p>
			{% if subtitle %}<p class="subtitle">{{subtitle}}</p>{% endif %}{% endcomment %}
			
			<dl>
				{% if bill.source != "statutesatlarge" %}
					<dt>Introduced:</dt>
					<dd>{{bill.introduced_date}}{% if not bill.is_alive %} ({{bill.congress|ordinalhtml}} Congress, {{congressdates.0|date:"Y"}}&ndash;{{congressdates.1|date:"Y"}}){% endif %}</dd>
				{% else %}
					{# from the SaL, the introduced date is not known #}
					<dt>Introduced:</dt>
					<dd>{{bill.congress|ordinalhtml}} Congress ({{congressdates.0|date:"Y"}}&ndash;{{congressdates.1|date:"Y"}})</dd>
				{% endif %}

				{% if bill.congress >= 93 %}
					<dt>Sponsor:</dt>
					{% if bill.sponsor %}
						<dd><a class="name" href="{{bill.sponsor.get_absolute_url}}">{{sponsor_name}}</a></dd>
					{% else %}
						<dd>(bill introduced by rule or other special circumstance)</dd>
					{% endif %}
				{% endif %}
			
				{% if bill.source != "americanmemory" %}
				<dt>Status:</dt>
				<dd>
					{% if bill.source == "statutesatlarge" and bill.noun == "bill" %}
						Enacted on {{bill.current_status_date}}
					{% elif bill.source == "statutesatlarge" and bill.noun == "resolution" %}
						Enacted or Agreed to on {{bill.current_status_date}}
					{% elif not dead %}
						{{bill.get_current_status_display}}
					{% else %}
						Died ({{bill.get_current_status_display}})
					{% endif %}
				</dd>
				{% endif %}
				
				{% with bill.slip_law_number as sln %}
				{% if sln %}
					<dt>Slip Law:</dt>
					<dd>This bill became {{bill.slip_law_number}}.</dd>
				{% endif %}
				{% endwith %}				
				
				{% if bill.docs_house_gov_postdate and bill.docs_house_gov_postdate.date > bill.current_status_date %}
				<dt>Schedule:</dt>
				<dd>The House Majority Leader indicated on {{bill.docs_house_gov_postdate|date:"DATE_FORMAT"}} that this {{bill.noun}} may be considered in the week ahead.</dd>
				{% endif %}
				
				{% if bill.senate_floor_schedule_postdate and bill.senate_floor_schedule_postdate.date > bill.current_status_date %}
				<dt>Schedule:</dt>
				<dd>This {{bill.noun}} was added to the Senate&rsquo;s floor schedule for the next legislative day on {{bill.senate_floor_schedule_postdate|date:"DATE_FORMAT"}}.</dd>
				{% endif %}
				
				{% if bill.get_upcoming_meetings|length %}
				<dt>Schedule:</dt>
				<dd>
					<div>This {{bill.noun}} is scheduled for the following committee meetings:</div>
					{% for m in bill.get_upcoming_meetings %}
						<div>{{m.when}} &mdash; {{m.committee.fullname}}</div>
					{% endfor %}
				</dd>
				{% endif %}
			
				{% with reintro_as=reintros.1 related_newer=bill.get_related_bills_newer %}
					
				{% if reintro_as %}
					<dt>See Instead:</dt>
					<dd>This bill was re-introduced as <a href="{{reintro_as.get_absolute_url}}">{{reintro_as.display_number}}</a> on {{reintro_as.introduced_date}}.
					{% if reintro_as.is_alive %}See <a href="{{reintro_as.get_absolute_url}}">{{reintro_as.display_number}}</a> for current action on this subject.{% endif %}</dd>
					
				{% elif related_newer %}
					<dt>See Instead:</dt>
					<dd>
					{% for rb in related_newer %}
						<p style="margin-bottom: .25em">
							<a href="{{rb.related_bill.get_absolute_url}}">{{rb.related_bill.display_number_no_congress_number}}</a>
							(same title)
							<br/>{{rb.related_bill.get_current_status_display}} &mdash; {{rb.related_bill.current_status_date|date}}
						</p>
					{% endfor %}
					</dd>
					
				{% endif %}
				
				{% endwith %}
				
				{% if bill.source == "statutesatlarge" %}
				{% with text as text_info %}
				<dt>Source:</dt>
				<dd>
					<a href="{{text_info.gpo_url}}">GPO FDSys &ndash; United States Statutes at Large</a>
				</dd>
				{% endwith %}
				{% elif bill.source == "americanmemory" %}
				<dt>Source:</dt>
				<dd>
					<a href="{{bill.source_link}}">American Memory Century of Lawmaking</a>
					<br/>(Click for scanned images of the {{bill.noun}}&rsquo;s text.)
				</dd>
				{% endif %}
				
			</dl>
			
			{% with bill.oursummary as summary %}
			{% if summary %}
				<p style="margin: 1em 0 0 0">{{summary.plain_text|truncatewords:30}} (<a href="#summary/oursummary">read more</a>)</p>
			{% endif %}
			{% endwith %}
			
		</div><!-- /info -->
		
	</div>
	
	{% if bill.is_alive %}
	<div class="aside col-sm-4" style="margin-top: -5px">
		<script>function show_track_panel() { return false; } /* default impl before script loaded */</script>
		<a href="#" class="track-btn" onclick="return show_track_panel();">Track this bill</a>
		<div id="event_subscribe_inline_container"> </div>
		
		<div id="action-button" style="display: none; margin: 12px 0;">
			<a class="push-btn yellow-btn"  href="#" onclick="$('#action-panel').modal(); ga('send', 'event', 'bill-action', 'what-can-i-do'); return false;">
				<span class="icon-speech-bubble-round-dots" style="color: #020"></span>
				<span style="text-shadow: none; margin-left: 3px; text-transform: none">Call Congress</span>
			</a>
		</div>
		<script>if (the_segment != "House" && the_segment != "Senate") $('#action-button').show();</script>

		<div class="modal fade" id="action-panel" tabindex="-1" role="dialog" aria-labelledby="actionPanelModalLabel" aria-hidden="true">
		  <div class="modal-dialog">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		        <h4 class="modal-title" id="actionPanelModalLabel">Call Congress</h4>
		      </div>
		      <div class="modal-body">
				<script>
					function do_poll(posid) {
						window.location = "{% url "bill_start_poll" %}?bill={{bill.id}}&position=" + posid;
					}
				</script>

				<div id="call_congress_positions">
					<p style="margin-bottom: 1em">A phone call to Congress is an effective way to let your voice be heard. We&rsquo;ll walk you through the whole thing. How do you feel about {{bill.display_number}}?</p>
					<button onclick="do_poll('support');" class="support">
						<div>I support {{bill.display_number}}</div>
						<span class="icon-thumbs-up-filled"></span>
					</button>
					<button onclick="do_poll('oppose');" class="oppose">
						<div>I oppose {{bill.display_number}}</div>
						<span class="icon-thumbs-down-filled"></span>
					</button>
				</div>
				<div id="call_congress_position_chosen" style="display: none;">
					<p style="margin-bottom: .5em;">You chose: <span style="font-weight: bold"/></p>
					<button id="change_position" onclick="$('#call_congress_positions').show(); $('#call_congress_position_chosen').hide();" style="margin-bottom: .5em">Change Position &nbsp; ▶</button>
					<button id="make_call" onclick="window.location = the_page.poll_and_call_position.call_url;" style="margin-bottom: .5em">Call Congress &nbsp; ▶</button>
					<div id="submission_status" style="display: none">
						Hello!
					</div>
				</div>
				<script>
				if (the_page && the_page.poll_and_call_position) {
					var p = the_page.poll_and_call_position;
					$('#call_congress_positions').hide();
					$('#call_congress_position_chosen').show();
					$('#call_congress_position_chosen span').text(p.text);
					$('#change_position').toggle(p.can_change);
					$('#make_call').toggle(p.can_call.length > 0);
				}
				</script>				
		      </div>
		    </div>
		  </div>
		</div>		

				
				<!--
				<h2 style="margin-top: 2em;">Next: Spread the Word</h2>
				<p>Share this {{bill.noun}} with your network of friends &mdash; especially friends in other congressional districts &mdash; to get the word out.</p>
		
				<div class="push-btn blue-facebook-btn-wide hover-state" style="cursor: default; width: 260px; text-align: left; padding: 4px 5px 4px 46px; font-size: 12px; line-height: 16px; text-transform: none; color: white; margin: 1em auto;">
					<div class="share-on-fb-working" style="display: none;">Updating your wall...</div>
					<div class="share-on-fb-new">
						<div>Write on Facebook: &ldquo;I
							<a href="#" onclick="return fb_share('support');">support</a>
							<span style="color: #EEE">or</span> <a href="#" onclick="return fb_share('oppose');">oppose</a>
							<span style="color: #EEE">or</span> <a href="#" onclick="return fb_share('track');">am tracking</a>
							this bill.&rdquo;
						</div>
					</div>
					<div class="share-on-fb-existing" style="display: none">
						You shared: &ldquo;<span> </span>&rdquo;
						[<a href="#" onclick="return fb_unshare();">Un-Share</a>]
					</div>
				</div>
				-->
	
	</div><!-- /actions -->
	{% endif %}

	<p class="helptext" style="clear: both; line-height: 110%; margin: 0 0 0 10px;"><small>
		{% if bill.explanatory_text %}{{bill.explanatory_text}}{% endif %}
		{% if bill.congress < 93 %}
			Limited information is available for bills and resolutions introduced before 1973 (the 93<sup>rd</sup> Congress).
		{% else %}
			{% if not bill.is_success %}
				The {{bill.noun}}&rsquo;s title was written by its sponsor.
			{% endif %}
			{{bill.get_bill_type_display}} stands for {{bill.bill_type_name}}.
		{% endif %}
	</small></p>
	
	<div id="admin_panel"> </div>
	<script>if (the_page.admin_panel) $('#admin_panel').html(the_page.admin_panel);</script>
</div>
{% endblock %}

{% block body %}

{% with text as text_info %}

<ul class="tabs five-up">
	<li><a href="#overview">Overview</a></li>
	<li><a href="#details">Details</a></li>
	
	{% if bill.source != "americanmemory" %}
	<li id="summary_tab" style="display: none"><a href="#summary">Summaries</a></li>
	<li id="comments_tab" style="display: none"><a href="#comments">Comments</a></li>
	{% endif %}
</ul>

<div class="panes">
	<div id="overview" style="padding: 1em">
							<!-- status -->
							<p>
								{% if bill.source == "statutesatlarge" %}
									{% if bill.noun == "bill" %}
										This bill was enacted on {{bill.current_status_date|date}}.
									{% else %}
										This resolution was enacted or agreed to on {{bill.current_status_date|date}}.
									{% endif %}
								{% elif bill.source == "americanmemory" %}
									We don&rsquo;t have status information for bills in this historical collection.
								{% elif not died %}
									{{bill.current_status_description}}
								{% else %}
									This {{bill.noun}} died in a previous session of Congress.
								{% endif %}
								Here&rsquo;s how it got there and where it is going.
							</p>

		<div class="row">
			{% for item in progress %}
		        {% if forloop.counter0|divisibleby:4 %}<div class="clearfix visible-sm visible-md visible-lg"></div>{% endif %}

				<div class="col-sm-3">
					<div class="visible-lg" style="height: {{forloop.counter0|mod:4|mult:13|to_int}}px">&nbsp;</div>
					<div class="visible-md" style="height: {{forloop.counter0|mod:4|mult:11|to_int}}px">&nbsp;</div>
					<div class="visible-sm" style="height: {{forloop.counter0|mod:4|mult:9|to_int}}px">&nbsp;</div>
					<div class="progress-item">
						<div class="date">
							{% if item.date %}
								{{item.date|date2}}
							{% endif %}
						</div>
						<div style="padding-top: 2em" title="{{item.extra}}">{{item.label}}</div>
					</div>
				</div>
			{% endfor %}
		</div>
	</div>

	<div id="details" style="padding: 1em"> <!-- details pane -->
		<div class="row">
			<div class="col-sm-6 col-md-4">
					<dl>
						{% with bill.get_prognosis as p %}
						{% if p %}
						<dt>Prognosis</dt>
						<dd>
							<p style="margin-bottom: 4px;"><b>{{p.prediction|floatformat:0}}%</b> chance of being {{p.success_name}}.</p>

							<p class="small">
							{% if p.is_introduced %}
								This {{bill.noun}} has a {{p.prediction_1|floatformat:0}}%</b> chance of getting past committee first.
								{% if 40 > p.success_rate_1 %}Only {% endif %}{{p.success_rate_1|floatformat:0}}% of {{p.bill_type_descr}} made it past committee
								and {% if 40 > p.success_rate %}only {% endif %} about {{p.success_rate|floatformat:0}}% were {{p.success_name_2}}
								in {{p.congressdates.0|date:"Y"}}&ndash;{{p.congressdates.1|date:"Y"}}.
							{% else %}
								{% if 40 > p.success_rate_2 %}Only about {% endif %}{{p.success_rate_2|floatformat:0}}% of {{p.bill_type_descr}} that made it past committee in {{p.congressdates.0|date:"Y"}}&ndash;{{p.congressdates.1|date:"Y"}} were {{p.success_name_2}}.
							{% endif %}
							[{% if p.factors_help_help or p.factors_hurt_hurt or p.factors_help_hurt or p.factors_hurt_help %}<a href="#" onclick="$('#prognosis_factors').slideToggle(); return false;">show factors</a> | {% endif %}<a href="/about/analysis#prognosis">methodology</a>]
							</small></p>
							
							<div id="prognosis_factors" style="display: none; margin-top: 1em;">
							<p style="margin-bottom: .5em">The following factors determined this {{bill.noun}}&rsquo;s prognosis:</p>

							{% if p.factors_help_help %}
							{% for factor in p.factors_help_help %}
								<p class="small" style="margin: .25em 1em .25em 1em;">{{factor}} <span>▲</span></p>
							{% endfor %}
							{% endif %}
							
							{% if p.factors_hurt_hurt %}
							{% for factor in p.factors_hurt_hurt %}
								<p class="small" style="margin: .25em 1em .25em 1em;">{{factor}} <span>▼</span></p>
							{% endfor %}
							{% endif %}
							
							{% if p.factors_help_hurt %}
							{% for factor in p.factors_help_hurt %}
								<p class="small" style="margin: .25em 1em .25em 1em;">{{factor}} <span>▲▼</span></p>
							{% endfor %}
							{% endif %}
							
							{% if p.factors_hurt_help %}
							{% for factor in p.factors_hurt_help %}
								<p class="small" style="margin: .25em 1em .25em 1em;">{{factor}} <span>▼▲</span></p>
							{% endfor %}
							{% endif %}

							<p class="small key">Key:
								{% if p.factors_help_help %}▲ Correlated with successful bills.{% endif %}
								{% if p.factors_hurt_hurt %}▼ Correlated with unsuccessful bills.{% endif %}
								{% if p.factors_help_hurt %}▲▼ Correlated with {{bill.noun}}s that get past committee but are not enacted.{% endif %}
								{% if p.factors_hurt_help %}▲▼ Correlated with {{bill.noun}}s that don&rsquo;t get past committee and with bills that are enacted.{% endif %}
								Correlation may not indicate causation.
							</p>

							</div>
						</dd>
						{% endif %}
						{% endwith %}
					</dl>
			</div>

			<div class="col-sm-6 col-md-4">
					<dl>
						<dt>Text</dt>
						<dd>
							{% if not text_info %}
								<p>Text not yet available.</p>
							{% elif text_info.has_displayable_text %}
								{% if bill.congress >= 112 %}
								<a href="{{bill.get_absolute_url}}/text">
									<img src="/{{text_info.thumbnail_path}}" width="75" style="float: left; margin-right: 1em; border: 1px solid #444;"/>
								</a>
								{% endif %}
								<p><a href="{{bill.get_absolute_url}}/text">Read {{bill.noun|capfirst}} Text &raquo;</a></p>
								<p class="small">Last updated {{text_info.docdate}}.<br/>{{text_info.numpages}}</p>
							{% else %}
								<a href="{{text_info.gpo_pdf_url}}">PDF</a> ({{text_info.docdate}})
							{% endif %}
						</dd>
					</dl>
			</div>
		</div> <!-- /row -->

		<div class="sep">&nbsp;</div>

		<div class="row">

		  	{% if subtitle %}
			<div class="col-sm-6 col-md-4">
			<dl>
						<dt>Full Title</dt>
						<dd><p>{{subtitle}}</p></dd>
			</dl>
			</div>
		  	{% endif %}
				
		<div class="col-sm-6 col-md-4">
					<dl>
						<dt>Primary Source</dt>
						{% if bill.congress >= 93 %}
						<dd>
							<p style="margin-bottom: .25em"><a href="{{bill.thomas_link}}">THOMAS.gov (The Library of Congress)</a></p>
							<p class="small" style="line-height: 130%">GovTrack gets most information from THOMAS, which is updated generally one day after events occur. Activity since the last update may not be reflected here. {% if bill.source == "thomas-congproj" %}Data comes via the <a href="https://github.com/unitedstates/congress">congress project</a>.{% endif %}</p>
						</dd>
						{% elif bill.source == "statutesatlarge" %}
						<dd>
							<!-- http://www.gpo.gov/fdsys/browse/collection.action?collectionCode=STATUTE -->
							<p style="margin-bottom: .25em"><a href="{{text_info.gpo_url}}">GPO FDSys &ndash; United States Statutes at Large</a></p>
							<p class="small">Historical information on bills from 1957-1972 is obtained from the Government Printing Office&rsquo;s United States Statutes at Large publication, via the <a href="https://github.com/unitedstates/congress">congress project</a>.</p>
						</dd>
						{% elif bill.source == "americanmemory" %}
						<dd>
							<p style="margin-bottom: .25em"><a href="{{bill.source_link}}">American Memory Century of Lawmaking</a></p>
							<p class="small">Historical information on bills from 1799-1873 comes from the Library of Congress&rsquo;s American Memory Century of Lawmaking collection, via the <a href="https://github.com/unitedstates/am_mem_law">am_mem_law project</a>.</p>
						</dd>
						{% endif %}
					</dl>
		</div> <!-- columns -->
		</div> <!-- row -->

		<div class="sep">&nbsp;</div>

		<div class="row">
			<div class="col-sm-6 col-md-4">
				<dl>
						{% if bill.votes.exists %}
							<dt>Votes</dt>
							<dd>
								{% for v in bill.votes.all %}
								<div class="{% if v.is_major %}major_{% else %}minor_{% endif %}vote" style="margin-bottom: 1em">
									<div><a href="{{v.get_absolute_url}}">
										{% if v.is_on_passage %}
											{{v.get_chamber_display}} Vote on Passage
										{% elif v.is_major %}
											{{v.get_chamber_display}}: {{v.vote_type}}
										{% else %}
											{{v}}
										{% endif %}
									</a></div>
									<div style="font-size: 90%">
									{% if v.is_on_passage and v.vote_type != "On Passage of the Bill" and v.vote_type != "On the Resolution" %}{{v.vote_type}}<br/>{% endif %}
									{{v.created}}<br/>
									{{v.summary}}
									</div>
									</div>
								{% endfor %}
								<p id="more_votes" style="display: none; font-style: italic;"><a href="#" onclick="return show_all_votes();">Show <span class='num'> </span> <span class='desc'> </span> vote(s)...</a><p>
								<p id="fewer_votes" style="display: none"><a href="#" onclick="return hide_minor_votes();">Hide minor vote(s)...</a><p>
							</dd>
							<script>
								var minor_votes = $('.minor_vote');
								if (minor_votes.length > 0) {
									$('#more_votes').show();
									$('#more_votes').find('span.num').text(minor_votes.length);
									$('#more_votes').find('span.desc').text($('.major_vote').length == 0 ? "" : "additional");
								}
								function show_all_votes() {
									$('.minor_vote').fadeIn();
									$('#more_votes').hide();
									$('#fewer_votes').show();
									return false;
								}
								function hide_minor_votes() {
									$('.minor_vote').fadeOut();
									$('#more_votes').show();
									$('#fewer_votes').hide();
									return false;
								}
							</script>
						{% endif %}
				

				
				{% if bill.congress >= 93 %}
						<dt>Cosponsors</dt>
						<dd>
							{% if bill.cosponsor_count == 0 %}
								none
							{% else %}
								<div title="{% for party, count in bill.cosponsor_counts_by_party %}{{count}} {{party}}s{% if not forloop.last %}, {% endif %}{% endfor %}">
								{{bill.cosponsor_count}} cosponsors ({% for party, count in bill.cosponsor_counts_by_party %}{{count}}{{party.0}}{% if not forloop.last %}, {% endif %}{% endfor %})
								(<a href="#" onclick="if (!$('#cosponsors').is(':visible')) $('#cosponsors').slideDown(); else $('#cosponsors').slideUp(); return false;">show</a>)
								</div>
								<div id="cosponsors" style="display: none">
									{% for cosp in bill.cosponsor_records %}
									<div><a href="{{cosp.person.get_absolute_url}}">{{cosp.person_name}}</a></div>
									{% if cosp.joined != bill.introduced_date %}
										<div style="margin-left: 1.5em; font-size: 85%">(joined {{cosp.joined}}{% if cosp.withdrawn %}; withdrawn {{cosp.withdrawn}}{% endif %})</div>
									{% else %}
										{% if cosp.withdrawn %} 
											<div style="margin-left: 1.5em; font-size: 85%">(withdrawn {{cosp.withdrawn}})</div>
										{% endif %}
									{% endif %}
									{% endfor %}
								</div>
							{% endif %}
						</dd>

					{% if bill.committees.exists %}
						<dt>Committees</dt>
						<dd>
							{% for c in bill.committees.all %}
								{% if not c.committee %}
									<p><a href="{{c.get_absolute_url}}">{{c|cut:"Committee on the "|cut:"Committee on "}}</a></p>
									{% for s in bill.committees.all %}
										{% if s.committee == c %}
											<p style="margin-left: 1em">
												<span style="color: #666">↪</span>
												<a href="{{s.get_absolute_url}}">{{s.name_no_article}}</a>
											</p>
										{% endif %}
									{% endfor %}
								{% endif %}
							{% endfor %}
							<p class="small" style="margin: 1em 0 0 0">The committee chair determines whether a {{bill.noun}} will move past the committee stage.</p>
						</dd>
					{% endif %}
				{% endif %}
				</dl>
			</div>

			<div class="col-sm-6 col-md-4">
				<dl>
				{% if bill.source != "americanmemory" %}
						<dt>Summary</dt>
						<dd id="summaries">
							<p>No summaries available.</p>
						</dd>
				{% endif %}
				</dl>
			</div>

			<div class="col-sm-6 col-md-4">
				<dl>
						<dt>Widget</dt>
						<dd>
							<p><a href="{{bill.get_absolute_url}}/widget">Get a bill status widget for your website &raquo;</a></p>
						</dd>

						<dt>Citation</dt>
						<dd>
							<script>function show_cite(fmt) {
								var v = $("#cite_" + fmt).is(":visible");
								$('#cite_apa, #cite_mla, #cite_wikipedia').slideUp();
								if (!v) $("#cite_" + fmt).slideDown();
								return false;
							}</script>
							<p style="margin: 0">Click a format for a citation suggestion:</p>
							<ul class="list-inline">
								<li><a href="#" onclick="return show_cite('apa')">APA</a></li>
								<li><a href="#" onclick="return show_cite('mla')">MLA</a></li>
								<li><a href="#" onclick="return show_cite('wikipedia')">Wikipedia Template</a></li>
							</ul>
							<p id="cite_apa" style="display: none">{{bill.display_number_no_congress_number}}--{{bill.congress|ordinal}} Congress: {{bill.title_no_number|truncatewords:15}}. ({{bill.introduced_date|date:"Y"}}). In www.GovTrack.us. Retrieved {% now "F j, Y" %}, from {{request.build_absolute_uri}}</p>

							<p id="cite_mla" style="display: none">&ldquo;{{bill.display_number_no_congress_number}}--{{bill.congress|ordinal}} Congress: {{bill.title_no_number|truncatewords:15}}.&rdquo; www.GovTrack.us. {{bill.introduced_date|date:"Y"}}. {% now "F j, Y" %} &lt;{{request.build_absolute_uri}}&gt;</p>

							<p id="cite_wikipedia" style="display: none">{{cite web<br/>
							|url={{request.build_absolute_uri}}<br/>
							|title={{bill.display_number_with_congress_number}}<br/>
							|accessdate={% now "F j, Y" %}<br/>
							|author={{bill.congress|ordinal}} Congress ({{bill.introduced_date|date:"Y"}})<br/>
							|date={{bill.introduced_date|date:"F j, Y"}}<br/>
							|work=Legislation<br/>
							|publisher=GovTrack.us<br/>
							|quote={{bill.title_no_number|truncatewords:15}}<br/>
							}}</p>
						</dd>
				</dl>
			</div>

		</div> <!-- /row -->

		<div class="sep">&nbsp;</div>

		<div class="row">
			<div class="col-sm-6 col-md-4">
				<dl>
						<dt>Related Bills</dt>
						<dd>
							{% if bill.relatedbills.exists %}
							<div>
							{% for rb in bill.get_related_bills %}
								<p style="margin-bottom: .25em;">
									{% if rb.relation != "unknown" %}{{rb.relation}}: {% endif %}<a href="{{rb.related_bill.get_absolute_url}}">
										{{rb.related_bill.display_number_no_congress_number}}: {{rb.related_bill.title_no_number|truncatewords:15}}
									</a>
								</p>
								<p class="small" style="margin-bottom: .75em;">
									{{rb.related_bill.get_current_status_display}}<br/>
									Last Action: {{rb.related_bill.current_status_date|date}}
								</p>
							{% endfor %}
							</div>
							<p class="small">Related bills are identified by the Library of Congress.</p>
							{% endif %}
							
							<p>Search for more <a href="/congress/bills/browse?congress={{bill.congress}}#similar_to={{bill.get_bill_type_display}}{{bill.number}}/{{bill.congress}}">similar bills</a>.</p>
						</dd>

				{% with reintros.0 as reintro_from %}
				{% if reintro_from %}
						<dt>Supersedes</dt>
						<dd>
							<p>This bill was a re-introduction of <a href="{{reintro_from.get_absolute_url}}">{{reintro_from.display_number}}</a> ({{reintro_from.introduced_date}}).</p>
						</dd>
				{% endif %}
				{% endwith %}

				</dl>
			</div>
			<div class="col-sm-6 col-md-4">
				<dl>
						<dt>Subject Areas:</dt>
						<dd>
							{% if bill.get_terms_sorted|length = 0 %}
								<p>None known at this time.</p>
							{% else %}
							<p>Use these subject areas to explore related legislation:</p>
							<div>
							{% for term in bill.get_terms_sorted %}
								<div><a {% if term.is_top_term %}style="font-weight: bold"{% endif %} href="{{term.get_absolute_url}}?congress={{bill.congress}}">{{term}}</a></div>
							{% endfor %}
							</div>
							{% endif %}
						</dd>
					</dl>
			</div>
		</div> <!-- /row -->

		{% if text_info.citations.count %}
		<div class="sep">&nbsp;</div>

		<div class="row">
		<div class="col-xs-12">
			<h2>Citations</h2>

			<p>The bill contains the following citations to other parts of U.S. law:</p>
		
			{% if text_info.citations.slip_laws %}
				<h3>Slip Laws</h3>
				<p>Slip laws refer to enacted bills and joint resolutions in their original form as enacted by Congress, that is, before other laws amend them. Slip laws are cited as &ldquo;Public Law XXX-YYY&rdquo;, where XXX is the number of the Congress in which the bill or resolution was introduced.</p>
				<ul class="bullets">
				{% for cite in text_info.citations.slip_laws %}
					<li>{{cite.text}}{% if cite.bill %}:<br/><a href="{{cite.bill.get_absolute_url}}">{{cite.bill}}</a>{% endif %}</li>
				{% endfor %}
				</ul>
			{% endif %}
			
			{% if text_info.citations.usc %}
				<h3>United States Code</h3>

				<p>The United States Code is the compilation of general and permanent laws enacted by Congress. Laws that are not 
				permanent in nature, law that affect a single individual, family, or small group, regulations, case law, state
				law, and local law do not appear in the United States Code.</p>
				
				<ul class="bullets">
				{% for cite in text_info.citations.usc %}
					<li style="margin-left: {{cite.indent}}em;">
						{% if cite.link %}<a href="{{cite.link}}">{{cite.text}}</a>{% else %}{{cite.text}}{% endif %}
						{% if cite.range_to_section %} (through {{cite.range_to_section}}){% endif %}
						</li>
				{% endfor %}
				</ul>
			{% endif %}
			
			{% if text_info.citations.statutes %}
				<h3>Statutes at Large</h3>
				<p>The United States Statutes at Large is the compilation of all laws enacted by Congress.</p>
				<ul class="bullets">
				{% for cite in text_info.citations.statutes %}
					<li>{{cite.text}}</li>
				{% endfor %}
				</ul>
			{% endif %}
			
			{% if text_info.citations.other %}
				<h3>Other Citations</h3>
				<ul class="bullets">
				{% for cite in text_info.citations.other %}
					<li>{{cite.text}}</li>
				{% endfor %}
				</ul>
			{% endif %}
		</div>
		</div> <!-- /row -->
		{% endif %}

	</div>  <!-- /details pane -->
	
	{% if bill.source != "americanmemory" %}
	<div id="summary" style="margin-left: 15px"> <!-- summary pane -->
		<div class="row">
		<div class="col-sm-3">
			<ul id="summary_tabs" class="left-tabs">
			</ul>
		</div>
	
		<div class="col-sm-9">
			<script>
			var first_summary = true;
			function add_summary(name, href, html) {
				// add a sub-tab
				$('#summary_tabs').append($('<li><a/></li>').find('a')
					.text(name ? name : "Our Summary").attr('href', '#summary/' + href));

				// add a link on the details, and show the tab
				var n = $('#summaries');
				if (first_summary) {
					n.text('');
					first_summary = false;
					$('#summary_tab').show();
				}
				
				var p1 = $('<p style="margin: 0;"><span/><a/></p>');
				p1.find('a').attr('href', '#summary/' + href);
				n.append(p1)
				if (!name) {
					p1.find('span').html(html);
					p1.find('a').text("more »");
					p1.attr('style', 'margin-bottom: 1em;');
				} else {
					p1.find('a').text(name + " »");
					var p2 = $('<p class="small" style="margin-bottom: .5em"/>');
					p2.html(html);
					n.append(p2)
				}
			}
			</script>

			<div id="oursummary" class="postcontent">
				<h3 style="margin-bottom: 1em">GovTrack&rsquo;s Bill Summary</h3>
				{% with bill.oursummary as summary %}
				{% if not summary %}
					<p>We don&rsquo;t have a summary available yet.</p>
				{% else %}
					{{summary.content|safe}}
					<div class="small" style="margin-top: 1em; border-top: 1px solid #666; padding-top: 1em">
						Last updated {{summary.modified|date}}.
						View <a href="/events/bill-summaries">all GovTrack summaries</a>.
					</div>
					<script>add_summary(null, "oursummary", "{{summary.plain_text|truncatewords:30|escapejs}}");</script>
				{% endif %}
				{% endwith %}
			</div>
			
			<div id="libraryofcongress" class="postcontent">
				<h3 style="margin-bottom: 1em">Library of Congress Summary</h3>
				<p>The summary below was written by the Congressional Research Service, which is a nonpartisan division of the Library of Congress.</p>
				<hr/>
				{% with bill.get_formatted_summary as summary %}
				{% if not summary %}
					<p>No summary available.</p>
				{% else %}
					{{summary|safe}}
					<script>add_summary("Library of Congress", "libraryofcongress", "{{summary|striptags|truncatewords:30|escapejs}}");</script>
				{% endif %}
				{% endwith %}
			</div>
			
			<div id="houserepublicans" class="postcontent">
				<h3 style="margin-bottom: 1em">House Republican Conference Summary</h3>
				<p>The summary below was written by the <a href="http://www.gop.gov">House Republican Conference</a>, which is the caucus of Republicans in the House of Representatives.</p>
				<hr/>
				{% with bill.get_gop_summary as gopsummary %}
					{% if not gopsummary %}
						<p>No summary available.</p>
					{% else %}
						<p>This summary can be found at <a href="{{gopsummary.link}}">{{gopsummary.link}}</a>.</p>
					
						{% if gopsummary.background %}
						<h4>Background</h4>
						{{gopsummary.background}}
						{% endif %}
						
						{% if gopsummary.summary %}
						<h4>Summary</h4>
						{{gopsummary.summary}}
						{% endif %}
						
						{% if gopsummary.cost %}
						<h4>Cost</h4>
						{{gopsummary.cost}}
						{% endif %}
						
						<script>add_summary("House Republicans", "houserepublicans", "{{gopsummary.text|truncatewords:30|escapejs}}");</script>
						<script>add_summary("House Democrats", "housedemocrats", "No summary available.");</script>
					{% endif %}
				{% endwith %}
			</div>
			
			<div id="housedemocrats" class="postcontent">
				<h3 style="margin-bottom: 1em">House Democratic Caucus Summary</h3>
				<p>The <a href="http://www.dems.gov/">House Democratic Caucus</a> does not provide summaries of bills.</p>
				<p>So, yes, we display the House Republican Conference&rsquo;s summaries when available even if we do not have a Democratic summary available. That&rsquo;s because we feel it is better to give you as much information as possible, even if we cannot provide every viewpoint.</p>
				<p>We&rsquo;ll be looking for a source of summaries from the other side in the meanwhile.</p>
			</div>
		</div>
		</div>
	</div> <!-- /summary pane -->

	


	<div id="comments" style="padding: 1em">
		<p style="text-align: center; font-style: italic; margin-bottom: 1em;">
			Use the comment space below for discussion of the merits of {{bill.display_number}} with other GovTrack users.<br/>
			Your comments are not read by Congressional staff.</p>
		</p>
	
		<div id="disqus_thread"></div>
		<script type="text/javascript">
			var disqus_shortname = 'govtrack'; // required: replace example with your forum shortname
			var disqus_identifier = '{{feed.feedname|escapejs}}';
			var disqus_title = '{{bill.display_number_with_congress_number|escapejs}}: {{bill.title_no_number|escapejs}}';
			var disqus_url = 'http://www.govtrack.us{{bill.get_absolute_url|escapejs}}';
			var disqus_loaded = false;
			function initialize_disqus() {
				if (disqus_loaded) return;
				disqus_loaded = true;
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			}
		</script>
		<noscript><a href="//disqus.com/?ref_noscript">Comments powered by Disqus</a> are not available without Javascript.</noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>    
	
	</div>
	{% endif %}
	
</div> <!--panes -->

{% include "ad_footer_leaderboard.html" %}

{% endwith %} {% comment %}bill text{% endcomment %}
				
<script>
$("ul.tabs a").tabs("div.panes > div", null, function(tabname) {
	if (tabname == "comments") {
		initialize_disqus();
	};
});
if (!first_summary) $("#summary_tabs a").tabs("#summary .col-sm-9 > div", "summary");</script>

{% if bill.congress >= 113 %}
<!-- disqus comment count, hacked from their count.js code -->
<script>
var DISQUSWIDGETS = {
	displayCount: function(obj) {
		var c = (obj && obj.counts && obj.counts.length > 0) ? obj.counts[0].comments : 0;
		var n = $('#comments_tab a');
		n.text(n.text() + " (" + c + ")");
		{% if not bill.is_alive %}if (c > 0) {% endif %}$('#comments_tab').show();
			
	}
};
</script>
<script src="//govtrack.disqus.com/count-data.js?1={{feed.feedname|urlencode}}"> </script>
{% endif %}

{% endblock %}
